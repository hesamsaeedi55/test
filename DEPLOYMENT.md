# Render Auto-Deployment Setup Guide

## Changes Made

### 1. Fixed Address Count Issue
- **File**: `AddressView.swift`
- **Fix**: Changed address loading to always reload on view appear (not just when nil/empty)
- **Issue**: Address count was showing 3 when user only had 2 addresses due to stale data

### 2. Git Repository Initialized
- Git repository has been initialized in the project root
- `.gitignore` updated to exclude Swift build files and backups

## Setup Render Auto-Deployment

### Step 1: Push to GitHub/GitLab

1. Create a new repository on GitHub (or use existing):
   ```bash
   # If you don't have a GitHub repo yet:
   # Go to https://github.com/new and create a new repository
   ```

2. Add all files and make initial commit:
   ```bash
   cd "/Users/hesamoddinsaeedi/Desktop/best/backup copy 64"
   git add .
   git commit -m "Fix address count issue and prepare for Render deployment"
   ```

3. Add remote and push:
   ```bash
   git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO_NAME.git
   git branch -M main
   git push -u origin main
   ```

### Step 2: Connect to Render

1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click "New +" → "Web Service"
3. Connect your GitHub/GitLab account
4. Select your repository
5. Render will automatically detect `render.yaml` in the root
6. Configure:
   - **Name**: myshop2 (or your preferred name)
   - **Environment**: Python 3
   - **Build Command**: `pip install -r requirements.txt` (or use build.sh if exists)
   - **Start Command**: `gunicorn myshop.wsgi:application`
7. Add environment variables in Render dashboard:
   - `SECRET_KEY` (auto-generated by Render)
   - `DATABASE_URL` (auto-configured from database)
   - `DEBUG=False`
   - `ALLOWED_HOSTS=your-app.onrender.com`

### Step 3: Database Setup

1. In Render dashboard, create a PostgreSQL database:
   - Name: `myshop2-db`
   - This will be automatically linked via `render.yaml`

2. Run migrations:
   ```bash
   # In Render shell or via build command:
   python manage.py migrate
   ```

### Step 4: Auto-Deployment

Once connected:
- ✅ Every push to `main` branch will automatically trigger deployment
- ✅ Render will build and deploy your app automatically
- ✅ You can see deployment logs in Render dashboard

## File Structure

```
.
├── render.yaml          # Render configuration
├── .gitignore          # Git ignore rules
├── myshop2/            # Django backend
│   └── myshop/
│       └── accounts/
│           └── views.py  # Address API endpoints
└── AddressView.swift   # Fixed SwiftUI view
```

## Verification

After deployment, test the address count fix:
1. Log in to your app
2. Go to addresses page
3. Delete an address
4. Verify count updates correctly (should show 2 instead of 3)

## Troubleshooting

If deployment fails:
1. Check build logs in Render dashboard
2. Verify `requirements.txt` exists in `myshop2/` directory
3. Ensure `render.yaml` is in the root directory
4. Check that database migrations have run

